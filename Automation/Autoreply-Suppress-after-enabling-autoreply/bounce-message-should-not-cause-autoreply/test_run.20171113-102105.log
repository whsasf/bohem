	**********  Starting /home/ram/workspace/bohem/Automation/Autoreply-Suppress-after-enabling-autoreply/bounce-message-should-not-cause-autoreply  **********
Test started: Mon Nov 13 10:21:05 CST 2017
########## 1 Clear mta.log using expect tool ...
spawn ssh imail2@10.49.58.118
Password: 
Last login: Sun Nov 12 21:18:02 2017 from bigchina
[?1034hmx-10-49-58-118:imail2:Mx9.5:~$ > ~/log/mta.log
mx-10-49-58-118:imail2:Mx9.5:~$ rm: cannot remove 'imapfetch*.log': No such file or directory
rm: cannot remove 'send*.log': No such file or directory
########## 2 Accounts provision ...
9191154876655674599
4997114431643914747
[32m########## 2 Accont provision successfully, we can continue now[0m
spawn ssh root@10.49.58.118
Password: 
Last login: Sun Nov 12 21:17:53 2017 from bigchina
]0;root@mx-10-49-58-118:~[?1034h[root@mx-10-49-58-118 ~]# date +%s
1510539534
]0;root@mx-10-49-58-118:~[root@mx-10-49-58-118 ~]# 
]0;root@mx-10-49-58-118:~[root@mx-10-49-58-118 ~]# ########## 4 Configure user2 and user1 to vacation autoreply mode using expect tool ...
spawn ssh imail2@10.49.58.118
Password: 
Last login: Sun Nov 12 21:18:48 2017 from bigchina
[?1034hmx-10-49-58-118:imail2:Mx9.5:~$ echo 'internal:' >data.txt
mx-10-49-58-118:imail2:Mx9.5:~$ echo 'Reply,This is an autoreply message for internal senders!' >>data.txt
mx-10-49-58-118:imail2:Mx9.5:~$ echo 'external:' >>data.txt
mx-10-49-58-118:imail2:Mx9.5:~$ echo 'Reply,This is an external autoreply message for external senders!' >>data.txt
mx-10-49-58-118:imail2:Mx9.5:~$ autoreplyctrl ar30878@openwave.com reply data.txt 1510539539 1510541334
AutoReply data updated Successfully.
mx-10-49-58-118:imail2:Mx9.5:~$ autoreplyctrl ar19828@openwave.com reply data.txt 1510539539 1510541334
AutoReply data updated Successfully.
mx-10-49-58-118:imail2:Mx9.5:~$ [32m##########4 Congifuration successfully[0m
##########5 delieber 1 message from user1 to user2 ...
[32m########## 5 Message Deliver successfully, we can continue now[0m
########## 6 Check mta.log using expect tool ...
spawn ssh imail2@10.49.58.118
Password: 
Last login: Sun Nov 12 21:19:03 2017 from bigchina
[?1034hmx-10-49-58-118:imail2:Mx9.5:~$ cat log/mta.log
20171112 211914145-0500 mx-10-49-58-118 mta 26417 27465 139676411995904 Note;SmtpConnectionReceived(70/1) [10.37.2.214]:fromhost=10.37.2.214:fromport=33652:localAddr=10.49.58.118:sid=57FAE7E5-8E748501-00000034.0
20171112 211914145-0500 mx-10-49-58-118 mta 26417 27465 139676411995904 Warn;SmtpAddressFixed(70/13) [10.37.2.214]:mail from\3aar19828:<ar19828>:fromhost=10.37.2.214:fromport=33652:localAddr=10.49.58.118:sid=57FAE7E5-8E748501-00000034.1
20171112 211914184-0500 mx-10-49-58-118 mta 26417 27465 139676411995904 Warn;SmtpAddressFixed(70/13) [10.37.2.214]:rcpt to\3aar30878:<ar30878>:from=<ar19828>:fromhost=10.37.2.214:fromport=33652:localAddr=10.49.58.118:sid=57FAE7E5-8E748501-00000034.1
20171112 211916925-0500 mx-10-49-58-118 mta 26417 27465 139676411995904 Note;MsgTrace(65/26) received from internet:from=<ar19828>:msgid=<20171113021914.ABG26417.mx-10-49-58-118.openwave.com@[10.37.2.214]>:fromhost=[10.37.2.214]:fromport=33652:localAddr=10.49.58.118:sid=57FAE7E5-8E748501-00000034.1:msgsize=1128817:time=2:sender=<ar19828>:rcpts=<ar30878@openwave.com>:protocol=SMTP:encoding=plaintext:auth=
20171112 211916925-0500 mx-10-49-58-118 mta 26417 27837 139676409067264 Note;MsgTrace(65/26) docid will be used for message-id:user=ar30878@openwave.com:from=<ar19828@openwave.com>:msgid=<20171113021914.ABG26417.mx-10-49-58-118.openwave.com@[10.37.2.214]>:size=1128929:fromhost=10.37.2.214:fromport=33652:localAddr=[10.49.58.118]:sid=57FAE7E5-8E748501-00000034.1
20171112 211916925-0500 mx-10-49-58-118 mta 26417 27465 139676411995904 Note;SmtpConnectionClosed(70/2) [10.37.2.214]:2:1:1118550:fromhost=[10.37.2.214]:fromport=33652:localAddr=10.49.58.118:sid=57FAE7E5-8E748501-00000034.1
20171112 211916984-0500 mx-10-49-58-118 mta 26417 27479 139676410398464 Note;MsgTrace(65/26) bounced:user=ar30878@openwave.com:mbox=4997114431643914747:mss=95xmc:from=<ar19828@openwave.com>:msgid=<20171113021914.ABG26417.mx-10-49-58-118.openwave.com@[10.37.2.214]>:size=1128966:port=55014:fromhost=10.37.2.214:fromport=33652:localAddr=[10.49.58.118]:sid=57FAE7E5-8E748501-00000034.1:docid=0c9a125e-c819-11e7-b3f5-9c20fc6fef22:node=mx-10-49-58-118:nodePort=55014
20171112 211916984-0500 mx-10-49-58-118 mta 26417 27474 139676411463424 Note;MsgTrace(65/26) handled by Error-Handler:mss=mx-10-49-58-118:from=<ar19828@openwave.com>:msgid=<20171113021914.ABG26417.mx-10-49-58-118.openwave.com@[10.37.2.214]>:size=1128929:port=55014:fromhost=10.37.2.214:fromport=33652:localAddr=[10.49.58.118]:sid=57FAE7E5-8E748501-00000034.1:msgfile=/opt/imail2/spool/control/495/20171113021914.ABG26417.mx-10-49-58-118.openwave.com@[10.37.2.214]-Control:msgid=<20171113021914.ABG26417.mx-10-49-58-118.openwave.com@[10.37.2.214]>
20171112 211916984-0500 mx-10-49-58-118 mta 26417 27474 139676411463424 Warn;MsLimitMsgSize(74/16) 1128966:4997114431643914747:user=ar30878@openwave.com:mbox=4997114431643914747:mss=95xmc:from=<ar19828@openwave.com>:msgid=<20171113021914.ABG26417.mx-10-49-58-118.openwave.com@[10.37.2.214]>:size=1128966:rme=MSS_SL_CREATEMESSAGEREPLY:port=55014:fromhost=10.37.2.214:fromport=33652:localAddr=[10.49.58.118]:sid=57FAE7E5-8E748501-00000034.1:docid=0c9a125e-c819-11e7-b3f5-9c20fc6fef22:node=mx-10-49-58-118:nodePort=55014
20171112 211916992-0500 mx-10-49-58-118 mta 26417 27474 139676411463424 Note;MsgTrace(65/26) MsLimitMsgSize (created by Error-Handler):mss=mx-10-49-58-118:from=<ar19828@openwave.com>:msgid=20171113021916.ABH26417.mx-10-49-58-118.openwave.com@mx-10-49-58-118:size=1128929:port=55014:fromhost=10.37.2.214:fromport=33652:localAddr=[10.49.58.118]:sid=57FAE7E5-8E748501-00000034.1:oldid=<20171113021914.ABG26417.mx-10-49-58-118.openwave.com@[10.37.2.214]>:oldfrom=<ar19828@openwave.com>:oldrcpts=<ar30878@openwave.com>
20171112 211917004-0500 mx-10-49-58-118 mta 26417 27838 139676408801024 Note;MsgTrace(65/26) docid will be used for message-id:user=ar19828@openwave.com:from=<>:msgid=<20171113021916.ABH26417.mx-10-49-58-118.openwave.com@mx-10-49-58-118>:size=453:sid=57FAE7E5-8E748501-00000034.1
20171112 211917086-0500 mx-10-49-58-118 mta 26417 28037 139676408002304 Note;MsgTrace(65/26) bounced:user=ar19828@openwave.com:mbox=9191154876655674599:mss=95xmc:from=<>:msgid=<20171113021916.ABH26417.mx-10-49-58-118.openwave.com@mx-10-49-58-118>:size=1130195:port=55014:sid=57FAE7E5-8E748501-00000034.1:docid=0ca3b070-c819-11e7-afd8-babbea96512e:node=mx-10-49-58-119:nodePort=55014
20171112 211917086-0500 mx-10-49-58-118 mta 26417 27837 139676409067264 Note;MsgTrace(65/26) handled by Error-Handler:mss=mx-10-49-58-119:from=<>:msgid=<20171113021916.ABH26417.mx-10-49-58-118.openwave.com@mx-10-49-58-118>:size=453:port=55014:sid=57FAE7E5-8E748501-00000034.1:msgfile=/opt/imail2/spool/control/175/20171113021916.ABH26417.mx-10-49-58-118.openwave.com@mx-10-49-58-118-Control:msgid=<20171113021916.ABH26417.mx-10-49-58-118.openwave.com@mx-10-49-58-118>
20171112 211917086-0500 mx-10-49-58-118 mta 26417 27837 139676409067264 Warn;MsLimitMsgSize(74/16) 1130195:9191154876655674599:user=ar19828@openwave.com:mbox=9191154876655674599:mss=95xmc:from=<>:msgid=<20171113021916.ABH26417.mx-10-49-58-118.openwave.com@mx-10-49-58-118>:size=1130195:rme=MSS_SL_CREATEMESSAGEREPLY:port=55014:sid=57FAE7E5-8E748501-00000034.1:docid=0ca3b070-c819-11e7-afd8-babbea96512e:node=mx-10-49-58-119:nodePort=55014
20171112 211917086-0500 mx-10-49-58-118 mta 26417 27837 139676409067264 Note;MsgTrace(65/26) moved to queue/errors directory:mss=mx-10-49-58-119:from=<>:msgid=<20171113021916.ABH26417.mx-10-49-58-118.openwave.com@mx-10-49-58-118>:size=453:port=55014:sid=57FAE7E5-8E748501-00000034.1:msgfile=20171113021917.ABI26417.mx-10-49-58-118.openwave.com@mx-10-49-58-118-Control:msgid=<20171113021916.ABH26417.mx-10-49-58-118.openwave.com@mx-10-49-58-118>:queuehost=mx-10-49-58-118
mx-10-49-58-118:imail2:Mx9.5:~$ [32m##########6 Autoreply messaeg undelievered successfully!![0m
########## 7 check autoreplied message in inbox of user1 ...
imapmail: host[10.49.58.118] port[20143] user[ar19828] pass[p] folder[inbox] message[2]
xx OK LOGIN completed
* 2 EXISTS
* OK [UNSEEN 1] First unseen message
* OK [UIDVALIDITY 1510539386] UIDs valid
* OK [UIDNEXT 1002] Predicted next UID
* FLAGS (\Answered \Flagged \Deleted \Draft \Seen)
* OK [PERMANENTFLAGS (\* \Answered \Flagged \Deleted \Draft \Seen)] Permanent flags
* 0 RECENT
xx OK [READ-WRITE] SELECT completed
* 2 FETCH (BODY[] {1144}
Return-Path: <>
From: admin
Subject: ATTENTION: Bounced Message Notification, bytes in the message!!
Date: Sun, 12 Nov 2017 21:16:53 -0500
Message-ID: b73b2050-c818-11e7-9bd6-34061e15fcf8

A message was sent to you that was returned to the sender(bounced)
because it would have caused your mailbox quota to be exceeded.

The following is the reason that the message was over quota:

       Quota Type: bytes in the message
  Quota Available: 100.0KB
      Total Quota: 100.0KB

The following is the information on the message that was bounced:

      Sender: Mail Administrator <Postmaster@openwave.com>
     Subject:  Mail System Error - Returned Mail with Subject: 
        Size: 1130195
  Message ID: 0ca3b070-c819-11e7-afd8-babbea96512e
        Date: Sun Nov 12 21:19:17 2017

    Reply-To:  <Postmaster@openwave.com>

The message was bounced from the following folder:

    INBOX

To fix this problem, delete some messages from your mailbox, and contact
the sender to resend the message.

If the size of the message is too big, contact the sender to reduce the
size of the message and resend the message.
 FLAGS (\Seen))
xx OK FETCH completed
* BYE IMAP4 server terminating connection
xx OK LOGOUT completed
imapmail: host[10.49.58.118] port[20143] user[ar30878] pass[p] folder[inbox] message[2]
xx OK LOGIN completed
* 2 EXISTS
* OK [UNSEEN 1] First unseen message
* OK [UIDVALIDITY 1510539530] UIDs valid
* OK [UIDNEXT 1002] Predicted next UID
* FLAGS (\Answered \Flagged \Deleted \Draft \Seen)
* OK [PERMANENTFLAGS (\* \Answered \Flagged \Deleted \Draft \Seen)] Permanent flags
* 0 RECENT
xx OK [READ-WRITE] SELECT completed
* 2 FETCH (BODY[] {1072}
Return-Path: <>
From: admin
Subject: ATTENTION: Bounced Message Notification, bytes in the message!!
Date: Sun, 12 Nov 2017 21:19:16 -0500
Message-ID: 0c9f2f14-c819-11e7-8e2a-28e7529ca591

A message was sent to you that was returned to the sender(bounced)
because it would have caused your mailbox quota to be exceeded.

The following is the reason that the message was over quota:

       Quota Type: bytes in the message
  Quota Available: 100.0KB
      Total Quota: 100.0KB

The following is the information on the message that was bounced:

      Sender: <ar19828@openwave.com>
     Subject: [No Subject]
        Size: 1128966
  Message ID: 0c9a125e-c819-11e7-b3f5-9c20fc6fef22
        Date: Sun Nov 12 21:19:16 2017

    Reply-To: [No Reply-To]

The message was bounced from the following folder:

    INBOX

To fix this problem, delete some messages from your mailbox, and contact
the sender to resend the message.

If the size of the message is too big, contact the sender to reduce the
size of the message and resend the message.
 FLAGS (\Seen))
xx OK FETCH completed
* BYE IMAP4 server terminating connection
xx OK LOGOUT completed
[31m##########7 Check autoreplied messaege failed!Please checl manually,Exiting now ...[0m
TESTFAILED: /home/ram/workspace/bohem/Automation/Autoreply-Suppress-after-enabling-autoreply/bounce-message-should-not-cause-autoreply: AutoReply in reply mode with message undelievered between start/stop date for internal sender test failed! (41 sec.)
##########  doing some clear job ...
[32m##########  Accont deleted successfully[0m
FAILED: /home/ram/workspace/bohem/Automation/Autoreply-Suppress-after-enabling-autoreply/bounce-message-should-not-cause-autoreply [20171113-102105] (44 sec.)
Test ended: Mon Nov 13 10:21:49 CST 2017

