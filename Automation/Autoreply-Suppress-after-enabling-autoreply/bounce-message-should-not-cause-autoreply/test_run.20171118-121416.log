	**********  Starting /home/whsasf/workspace/bohem/Automation/Autoreply-Suppress-after-enabling-autoreply/bounce-message-should-not-cause-autoreply  **********
Test started: Sat Nov 18 12:14:16 CST 2017
########## 1 Clear mta.log using expect tool ...
spawn ssh imail2@10.49.58.118
Password: 
Last login: Fri Nov 17 23:11:42 2017 from 10.6.105.91
[?1034hmx-10-49-58-118:imail2:Mx9.5:~$ > ~/log/mta.log
mx-10-49-58-118:imail2:Mx9.5:~$ ########## 2 Accounts provision ...
8466372790423925265
7522067560396112459
[32m########## 2 Accont provision successfully, we can continue now[0m
spawn ssh root@10.49.58.118
Last login: Fri Nov 17 23:10:13 2017 from 10.6.105.91
]0;root@mx-10-49-58-118:~[?1034h[root@mx-10-49-58-118 ~]# date +%s
1510978365
]0;root@mx-10-49-58-118:~[root@mx-10-49-58-118 ~]# 
]0;root@mx-10-49-58-118:~[root@mx-10-49-58-118 ~]# ########## 4 Configure user2 and user1 to vacation autoreply mode using expect tool ...
spawn ssh imail2@10.49.58.118
Password: 
Last login: Fri Nov 17 23:11:52 2017 from 10.6.105.91
[?1034hmx-10-49-58-118:imail2:Mx9.5:~$ echo 'internal:' >data.txt
mx-10-49-58-118:imail2:Mx9.5:~$ echo 'Reply,This is an autoreply message for internal senders!' >>data.txt
mx-10-49-58-118:imail2:Mx9.5:~$ echo 'external:' >>data.txt
mx-10-49-58-118:imail2:Mx9.5:~$ echo 'Reply,This is an external autoreply message for external senders!' >>data.txt
mx-10-49-58-118:imail2:Mx9.5:~$ autoreplyctrl ar22244@openwave.com reply data.txt 1510978370 1510980165
AutoReply data updated Successfully.
mx-10-49-58-118:imail2:Mx9.5:~$ autoreplyctrl ar24709@openwave.com reply data.txt 1510978370 1510980165
AutoReply data updated Successfully.
mx-10-49-58-118:imail2:Mx9.5:~$ [32m##########4 Congifuration successfully[0m
##########5 delieber 1 message from user1 to user2 ...
[32m########## 5 Message Deliver successfully, we can continue now[0m
########## 6 Check mta.log using expect tool ...
spawn ssh imail2@10.49.58.118
Password: 
Last login: Fri Nov 17 23:13:08 2017 from 10.6.105.91
[?1034hmx-10-49-58-118:imail2:Mx9.5:~$ cat log/mta.log
20171117 231315893-0500 mx-10-49-58-118 mta 28284 29537 140306452186880 Note;SmtpConnectionReceived(70/1) [10.6.105.91]:fromhost=10.6.105.91:fromport=59144:localAddr=10.49.58.118:sid=EF5D77B7-75D8442B-00000032.0
20171117 231315893-0500 mx-10-49-58-118 mta 28284 29537 140306452186880 Warn;SmtpAddressFixed(70/13) [10.6.105.91]:mail from\3aar24709:<ar24709>:fromhost=10.6.105.91:fromport=59144:localAddr=10.49.58.118:sid=EF5D77B7-75D8442B-00000032.1
20171117 231315929-0500 mx-10-49-58-118 mta 28284 29537 140306452186880 Warn;SmtpAddressFixed(70/13) [10.6.105.91]:rcpt to\3aar22244:<ar22244>:from=<ar24709>:fromhost=10.6.105.91:fromport=59144:localAddr=10.49.58.118:sid=EF5D77B7-75D8442B-00000032.1
20171117 231322977-0500 mx-10-49-58-118 mta 28284 29544 140306434819840 Note;MsgTrace(65/26) docid will be used for message-id:user=ar22244@openwave.com:from=<ar24709@openwave.com>:msgid=<20171118041315.ABK28284.mx-10-49-58-118.openwave.com@[10.6.105.91]>:size=1128929:fromhost=10.6.105.91:fromport=59144:localAddr=[10.49.58.118]:sid=EF5D77B7-75D8442B-00000032.1
20171117 231322978-0500 mx-10-49-58-118 mta 28284 29537 140306452186880 Note;MsgTrace(65/26) received from internet:from=<ar24709>:msgid=<20171118041315.ABK28284.mx-10-49-58-118.openwave.com@[10.6.105.91]>:fromhost=[10.6.105.91]:fromport=59144:localAddr=10.49.58.118:sid=EF5D77B7-75D8442B-00000032.1:msgsize=1128817:time=7:sender=<ar24709>:rcpts=<ar22244@openwave.com>:protocol=SMTP:encoding=plaintext:auth=
20171117 231322978-0500 mx-10-49-58-118 mta 28284 29537 140306452186880 Note;SmtpConnectionClosed(70/2) [10.6.105.91]:7:1:1118550:fromhost=[10.6.105.91]:fromport=59144:localAddr=10.49.58.118:sid=EF5D77B7-75D8442B-00000032.1
20171117 231323042-0500 mx-10-49-58-118 mta 28284 30127 140306432157440 Note;MsgTrace(65/26) bounced:user=ar22244@openwave.com:mbox=7522067560396112459:mss=95xmc:from=<ar24709@openwave.com>:msgid=<20171118041315.ABK28284.mx-10-49-58-118.openwave.com@[10.6.105.91]>:size=1128966:port=55014:fromhost=10.6.105.91:fromport=59144:localAddr=[10.49.58.118]:sid=EF5D77B7-75D8442B-00000032.1:docid=d13b6c74-cc16-11e7-9a7f-2270a753bed8:node=mx-10-49-58-118:nodePort=55014
20171117 231323042-0500 mx-10-49-58-118 mta 28284 29545 140306434553600 Note;MsgTrace(65/26) handled by Error-Handler:mss=mx-10-49-58-118:from=<ar24709@openwave.com>:msgid=<20171118041315.ABK28284.mx-10-49-58-118.openwave.com@[10.6.105.91]>:size=1128929:port=55014:fromhost=10.6.105.91:fromport=59144:localAddr=[10.49.58.118]:sid=EF5D77B7-75D8442B-00000032.1:msgfile=/opt/imail2/spool/control/464/20171118041315.ABK28284.mx-10-49-58-118.openwave.com@[10.6.105.91]-Control:msgid=<20171118041315.ABK28284.mx-10-49-58-118.openwave.com@[10.6.105.91]>
20171117 231323042-0500 mx-10-49-58-118 mta 28284 29545 140306434553600 Warn;MsLimitMsgSize(74/16) 1128966:7522067560396112459:user=ar22244@openwave.com:mbox=7522067560396112459:mss=95xmc:from=<ar24709@openwave.com>:msgid=<20171118041315.ABK28284.mx-10-49-58-118.openwave.com@[10.6.105.91]>:size=1128966:rme=MSS_SL_CREATEMESSAGEREPLY:port=55014:fromhost=10.6.105.91:fromport=59144:localAddr=[10.49.58.118]:sid=EF5D77B7-75D8442B-00000032.1:docid=d13b6c74-cc16-11e7-9a7f-2270a753bed8:node=mx-10-49-58-118:nodePort=55014
20171117 231323049-0500 mx-10-49-58-118 mta 28284 29545 140306434553600 Note;MsgTrace(65/26) MsLimitMsgSize (created by Error-Handler):mss=mx-10-49-58-118:from=<ar24709@openwave.com>:msgid=20171118041323.ABL28284.mx-10-49-58-118.openwave.com@mx-10-49-58-118:size=1128929:port=55014:fromhost=10.6.105.91:fromport=59144:localAddr=[10.49.58.118]:sid=EF5D77B7-75D8442B-00000032.1:oldid=<20171118041315.ABK28284.mx-10-49-58-118.openwave.com@[10.6.105.91]>:oldfrom=<ar24709@openwave.com>:oldrcpts=<ar22244@openwave.com>
20171117 231323061-0500 mx-10-49-58-118 mta 28284 29544 140306434819840 Note;MsgTrace(65/26) docid will be used for message-id:user=ar24709@openwave.com:from=<>:msgid=<20171118041323.ABL28284.mx-10-49-58-118.openwave.com@mx-10-49-58-118>:size=453:sid=EF5D77B7-75D8442B-00000032.1
20171117 231323102-0500 mx-10-49-58-118 mta 28284 30550 140306431624960 Note;MsgTrace(65/26) bounced:user=ar24709@openwave.com:mbox=8466372790423925265:mss=95xmc:from=<>:msgid=<20171118041323.ABL28284.mx-10-49-58-118.openwave.com@mx-10-49-58-118>:size=1130195:port=55014:sid=EF5D77B7-75D8442B-00000032.1:docid=d145e79e-cc16-11e7-8316-7a48171b502d:node=mx-10-49-58-118:nodePort=55014
20171117 231323102-0500 mx-10-49-58-118 mta 28284 29545 140306434553600 Note;MsgTrace(65/26) handled by Error-Handler:mss=mx-10-49-58-118:from=<>:msgid=<20171118041323.ABL28284.mx-10-49-58-118.openwave.com@mx-10-49-58-118>:size=453:port=55014:sid=EF5D77B7-75D8442B-00000032.1:msgfile=/opt/imail2/spool/control/399/20171118041323.ABL28284.mx-10-49-58-118.openwave.com@mx-10-49-58-118-Control:msgid=<20171118041323.ABL28284.mx-10-49-58-118.openwave.com@mx-10-49-58-118>
20171117 231323102-0500 mx-10-49-58-118 mta 28284 29545 140306434553600 Warn;MsLimitMsgSize(74/16) 1130195:8466372790423925265:user=ar24709@openwave.com:mbox=8466372790423925265:mss=95xmc:from=<>:msgid=<20171118041323.ABL28284.mx-10-49-58-118.openwave.com@mx-10-49-58-118>:size=1130195:rme=MSS_SL_CREATEMESSAGEREPLY:port=55014:sid=EF5D77B7-75D8442B-00000032.1:docid=d145e79e-cc16-11e7-8316-7a48171b502d:node=mx-10-49-58-118:nodePort=55014
20171117 231323114-0500 mx-10-49-58-118 mta 28284 29545 140306434553600 Note;MsgTrace(65/26) moved to queue/errors directory:mss=mx-10-49-58-118:from=<>:msgid=<20171118041323.ABL28284.mx-10-49-58-118.openwave.com@mx-10-49-58-118>:size=453:port=55014:sid=EF5D77B7-75D8442B-00000032.1:msgfile=20171118041323.ABM28284.mx-10-49-58-118.openwave.com@mx-10-49-58-118-Control:msgid=<20171118041323.ABL28284.mx-10-49-58-118.openwave.com@mx-10-49-58-118>:queuehost=mx-10-49-58-118
mx-10-49-58-118:imail2:Mx9.5:~$ [32m##########6 Autoreply messaeg undelievered successfully!![0m
########## 7 check autoreplied message in inbox of user1 ...
imapmail: host[10.49.58.118] port[20143] user[ar24709] pass[p] folder[inbox] message[2]
xx OK LOGIN completed
* 2 EXISTS
* OK [UNSEEN 1] First unseen message
* OK [UIDVALIDITY 1510978314] UIDs valid
* OK [UIDNEXT 1002] Predicted next UID
* FLAGS (\Answered \Flagged \Deleted \Draft \Seen)
* OK [PERMANENTFLAGS (\* \Answered \Flagged \Deleted \Draft \Seen)] Permanent flags
* 0 RECENT
xx OK [READ-WRITE] SELECT completed
* 2 FETCH (BODY[] {1144}
Return-Path: <>
From: admin
Subject: ATTENTION: Bounced Message Notification, bytes in the message!!
Date: Fri, 17 Nov 2017 23:13:23 -0500
Message-ID: d14bfb0c-cc16-11e7-902d-15da393edb00

A message was sent to you that was returned to the sender(bounced)
because it would have caused your mailbox quota to be exceeded.

The following is the reason that the message was over quota:

       Quota Type: bytes in the message
  Quota Available: 100.0KB
      Total Quota: 100.0KB

The following is the information on the message that was bounced:

      Sender: Mail Administrator <Postmaster@openwave.com>
     Subject:  Mail System Error - Returned Mail with Subject: 
        Size: 1130195
  Message ID: d145e79e-cc16-11e7-8316-7a48171b502d
        Date: Fri Nov 17 23:13:23 2017

    Reply-To:  <Postmaster@openwave.com>

The message was bounced from the following folder:

    INBOX

To fix this problem, delete some messages from your mailbox, and contact
the sender to resend the message.

If the size of the message is too big, contact the sender to reduce the
size of the message and resend the message.
 FLAGS (\Seen))
xx OK FETCH completed
* BYE IMAP4 server terminating connection
xx OK LOGOUT completed
imapmail: host[10.49.58.118] port[20143] user[ar22244] pass[p] folder[inbox] message[2]
xx OK LOGIN completed
* 2 EXISTS
* OK [UNSEEN 1] First unseen message
* OK [UIDVALIDITY 1510978314] UIDs valid
* OK [UIDNEXT 1002] Predicted next UID
* FLAGS (\Answered \Flagged \Deleted \Draft \Seen)
* OK [PERMANENTFLAGS (\* \Answered \Flagged \Deleted \Draft \Seen)] Permanent flags
* 0 RECENT
xx OK [READ-WRITE] SELECT completed
* 2 FETCH (BODY[] {1072}
Return-Path: <>
From: admin
Subject: ATTENTION: Bounced Message Notification, bytes in the message!!
Date: Fri, 17 Nov 2017 23:13:23 -0500
Message-ID: d1414a9a-cc16-11e7-a297-28f634e7b3cd

A message was sent to you that was returned to the sender(bounced)
because it would have caused your mailbox quota to be exceeded.

The following is the reason that the message was over quota:

       Quota Type: bytes in the message
  Quota Available: 100.0KB
      Total Quota: 100.0KB

The following is the information on the message that was bounced:

      Sender: <ar24709@openwave.com>
     Subject: [No Subject]
        Size: 1128966
  Message ID: d13b6c74-cc16-11e7-9a7f-2270a753bed8
        Date: Fri Nov 17 23:13:22 2017

    Reply-To: [No Reply-To]

The message was bounced from the following folder:

    INBOX

To fix this problem, delete some messages from your mailbox, and contact
the sender to resend the message.

If the size of the message is too big, contact the sender to reduce the
size of the message and resend the message.
 FLAGS (\Seen))
xx OK FETCH completed
* BYE IMAP4 server terminating connection
xx OK LOGOUT completed
[32m##########7 Check autoreplied messaege successfully!![0m
TESTPASSED: /home/whsasf/workspace/bohem/Automation/Autoreply-Suppress-after-enabling-autoreply/bounce-message-should-not-cause-autoreply: AutoReply in reply mode with message undelievered between start/stop date for internal sender test success! (112 sec.)
##########  doing some clear job ...
[32m##########  Accont deleted successfully[0m
PASSED: /home/whsasf/workspace/bohem/Automation/Autoreply-Suppress-after-enabling-autoreply/bounce-message-should-not-cause-autoreply [20171118-121416] (115 sec.) 20
Test ended: Sat Nov 18 12:16:11 CST 2017

