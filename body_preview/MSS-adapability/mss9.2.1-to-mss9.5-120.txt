(1)Setup environment with MSS9.2.1 and other MX components in MX9.5-120.

host-172-26-202-233:imail2:Mx9.2:~$ rpm -qa|grep owm
owm-common-9.2.1.0-99.el6.x86_64
owm-sur-cache-9.2.1.0-99.el6.x86_64
owm-msg-popserv-9.2.1.0-99.el6.x86_64
owm-confserv-9.2.1.0-99.el6.x86_64
owm-sur-master-9.2.1.0-99.el6.x86_64
owm-msg-common-9.2.1.0-99.el6.x86_64
owm-msg-imapserv-9.2.1.0-99.el6.x86_64
owm-msg-extserv-9.2.1.0-99.el6.x86_64
owm-msg-mta-9.2.1.0-99.el6.x86_64
owm-sur-common-9.2.1.0-99.el6.x86_64
owm-msg-mss-9.2.1.0-99.el6.x86_64
owm-msg-qserv-9.2.1.0-99.el6.x86_64


[cassandra@host-172-26-202-234 bin]$ rpm -qa|grep owm
owm-queue-search-1.0.0.5-2_1.noarch
owm-common-9.2.1.0-99.el6.x86_64
owm-msg-mss-9.2.1.0-99.el6.x86_64
owm-queue-admin-1.0.0.5-2_1.noarch
owm-msg-common-9.2.1.0-99.el6.x86_64
owm-queue-service-1.0.0.5-2_1.noarch
owm-mxos-api-test-1.0.0-SNAPSHOT20161217045230.noarch


host-172-26-202-245:imail2:Mx9.2:~$ rpm -qa|grep owm
owm-mxos-thirdparty-2.4.2-1.noarch
owm-nginx-1.3.0-0.x86_64
owm-mxos-2.4.7-1_1.noarch
owm-service-discovery-1.0.3-1.noarch
owm-common-9.2.1.0-99.el6.x86_64

(2)Create users: xx1@openwave.com   9114157793439000693
(3)Enable this key: /*/common/enableXFIRSTLINE: [true]
(4)send 2 messages to xx1 from xx2:
////////////////////////////////////////////////////////////////////////////////////
* 2 FETCH (RFC822 {516}
Return-Path: <xx2@openwave.com>
Received: from [10.37.2.214] by host-172-26-202-233.openwave.com
          (InterMail vM.9.02.01.00 201-2473-137-107-100) with SMTP
          id <20170315103700.AAA7590.host-172-26-202-233.openwave.com@[10.37.2.214]>
          for <xx1@openwave.com>; Wed, 15 Mar 2017 03:37:00 -0700
Date: Wed, 15 Mar 2017 03:37:06 -0700
Message-Id: <20170315103700.AAA7590.host-172-26-202-233.openwave.com@[10.37.2.214]>
From: <xx2@openwave.com>

hi,xx1.this is first email.jajhajhaaajjaja
 FLAGS (\Recent \Seen))
* 3 FETCH (RFC822 {521}
Return-Path: <xx2@openwave.com>
Received: from [10.37.2.214] by host-172-26-202-233.openwave.com
          (InterMail vM.9.02.01.00 201-2473-137-107-100) with SMTP
          id <20170315103726.AAB7590.host-172-26-202-233.openwave.com@[10.37.2.214]>
          for <xx1@openwave.com>; Wed, 15 Mar 2017 03:37:26 -0700
Date: Wed, 15 Mar 2017 03:37:32 -0700
Message-Id: <20170315103726.AAB7590.host-172-26-202-233.openwave.com@[10.37.2.214]>
From: <xx2@openwave.com>

hi,xx1.this is xx2.dhkgsdifgsdkfsdgfkjsdgfsdjkf
 FLAGS (\Recent \Seen))
a OK FETCH completed


/////////////////////////////////////////////////////////////////////////////////////////////////////////



(5)check if firstline data created in cassandra:
--------------------------------------------------------------------------------
 [default@KeyspaceMetadata]  get cf_folder['383830373530313231393533343039373332375f3647b71c097111e7a1e266e1f877da7b'];
=> (super_column=3648fdde-0971-11e7-b2ae-95fd6edf214e,
     (name=31, value=392e300333363438666464652d303937312d313165372d623261652d3935666436656466323134650330033134383935373637353003343035033003033303300330030357656c636f6d6520746f2053796e6368726f6e6f737320456d61696c033c696e666f406f776d6573736167696e672e636f6d3e0330030303313030300330033c57656c636f6d653e033003030303, timestamp=1489576750488915)
     (name=32, value=46, timestamp=1489576750488915)
     (name=33, value=46, timestamp=1489576750488915)
     (name=35, value=30, timestamp=1489576750488915))
=> (super_column=d0c672d8-0971-11e7-a7e8-8c1b689a0804,
     (name=31, value=392e300364306336373264382d303937312d313165372d613765382d38633162363839613038303403300331343839353737303039033530360330030333033003300303033c787832406f70656e776176652e636f6d3e0330030303313030310330033c32303137303331353131323332342e414141343533352e686f73742d3137322d32362d3230322d3233332e6f70656e776176652e636f6d405b31302e33372e322e3231345d3e033134383935373730303903030303, timestamp=1489577009715170)
     (name=32, value=46, timestamp=1489577051009032)
     (name=33, value=46, timestamp=1489577009715170)
     (name=35, value=30, timestamp=1489577009715170))
=> (super_column=e30e6a18-0971-11e7-b313-ac61f28f7ecb,
     (name=31, value=392e300365333065366131382d303937312d313165372d623331332d61633631663238663765636203300331343839353737303430033530370330030333033003300303033c787832406f70656e776176652e636f6d3e0330030303313030320330033c32303137303331353131323335342e414142343533352e686f73742d3137322d32362d3230322d3233332e6f70656e776176652e636f6d405b31302e33372e322e3231345d3e033134383935373730343003030303, timestamp=1489577040376584)
     (name=32, value=46, timestamp=1489577051009073)
     (name=33, value=54, timestamp=1489577054674170)
     (name=35, value=31343839353737303534, timestamp=1489577054670555)
     (name=36, value=46, timestamp=1489577054674170)
     (name=37, value=46, timestamp=1489577054674170)
     (name=38, value=46, timestamp=1489577054674170)
     (name=39, value=46, timestamp=1489577054674170))
Returned 3 results.
Elapsed time: 9.47 msec(s)
-------------------------------------------------------------------------------
Summary:NO firstline data created in cassandra when using mss9.2.1.


(6)get firstlinev data from xx1 using IMAP:
  --(1)a capability
  * CAPABILITY IMAP4rev1 UIDPLUS NAMESPACE QUOTA IDLE SORT SORT=DISPLAY MOVE ID THREAD=ORDEREDSUBJECT THREAD=REFERENCES
  a OK CAPABILITY completed   //no x-firstline

  --(2)
a fetch 2 firstline
a BAD Invalid attribute list in FETCH


Summary:  also can not get firstline data from IMAP.



(7) upgrade MX9.2.1  to MX9.5:stop all services before upgrade
(8)After upgrading, firstline feature works fine.

  

